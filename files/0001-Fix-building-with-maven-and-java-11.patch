From d6946349c6a5dd963142b3e935fd59b727a4bd70 Mon Sep 17 00:00:00 2001
From: Campbell Jones <git@serebit.com>
Date: Mon, 8 Jun 2020 19:19:33 -0400
Subject: [PATCH] Fix building with maven and java 11

---
 .../META-INF/MANIFEST.MF                      |  7 +-
 .../build.properties                          |  7 +-
 .../app/editors.richnote.libreoffice/pom.xml  | 75 +++++++++++--------
 .../META-INF/MANIFEST.MF                      |  2 +
 .../build.properties                          |  4 +-
 .../core.utils/META-INF/MANIFEST.MF           |  3 +-
 .../platform.core/core.utils/build.properties |  3 +-
 modelio/platform.core/core.utils/pom.xml      | 31 ++++++++
 pom.xml                                       |  1 +
 9 files changed, 95 insertions(+), 38 deletions(-)

diff --git a/modelio/app/editors.richnote.libreoffice/META-INF/MANIFEST.MF b/modelio/app/editors.richnote.libreoffice/META-INF/MANIFEST.MF
index 500041d..713826b 100644
--- a/modelio/app/editors.richnote.libreoffice/META-INF/MANIFEST.MF
+++ b/modelio/app/editors.richnote.libreoffice/META-INF/MANIFEST.MF
@@ -4,7 +4,12 @@ Bundle-Name: Libreoffice
 Bundle-SymbolicName: org.modelio.editors.richnote.libreoffice;singleton:=true
 Bundle-Version: 4.0.1.qualifier
 Bundle-ClassPath: res/,
- .
+    target/dependency/juh.jar,
+    target/dependency/jurt.jar,
+    target/dependency/ridl.jar,
+    target/dependency/unoil.jar,
+    lib/javadesigner.jar,
+    .
 Bundle-Activator: org.modelio.editors.richnote.libreoffice.plugin.LibreOfficeEditors
 Bundle-Localization: plugin
 Require-Bundle: org.modelio.editors.richnote,
diff --git a/modelio/app/editors.richnote.libreoffice/build.properties b/modelio/app/editors.richnote.libreoffice/build.properties
index a450053..f4df5b9 100644
--- a/modelio/app/editors.richnote.libreoffice/build.properties
+++ b/modelio/app/editors.richnote.libreoffice/build.properties
@@ -10,4 +10,9 @@ bin.includes = META-INF/,\
                runtime/bin/,\
                res/,\
                plugin.xml,\
-               plugin.properties
+               plugin.properties,\
+               target/dependency/juh.jar,\
+               target/dependency/jurt.jar,\
+               target/dependency/ridl.jar,\
+               target/dependency/unoil.jar,\
+               lib/javadesigner.jar
diff --git a/modelio/app/editors.richnote.libreoffice/pom.xml b/modelio/app/editors.richnote.libreoffice/pom.xml
index 118352f..f61c37b 100644
--- a/modelio/app/editors.richnote.libreoffice/pom.xml
+++ b/modelio/app/editors.richnote.libreoffice/pom.xml
@@ -21,39 +21,6 @@
 				<version>${tycho-version}</version>
 				<configuration>
 					<useProjectSettings>true</useProjectSettings>
-					<extraClasspathElements>
-
-						<extraClasspathElement>
-							<groupId>org.modelio</groupId>
-							<artifactId>javadesigner</artifactId>
-							<version>2.2.0</version>
-						</extraClasspathElement>
-
-						<extraClasspathElement>
-							<groupId>org.modelio.libreoffice</groupId>
-							<artifactId>com.sun.star.juh</artifactId>
-							<version>3.6.0</version>
-						</extraClasspathElement>
-
-						<extraClasspathElement>
-							<groupId>org.modelio.libreoffice</groupId>
-							<artifactId>com.sun.star.jurt</artifactId>
-							<version>3.6.0</version>
-						</extraClasspathElement>
-
-						<extraClasspathElement>
-							<groupId>org.modelio.libreoffice</groupId>
-							<artifactId>com.sun.star.ridl</artifactId>
-							<version>3.6.0</version>
-						</extraClasspathElement>
-
-						<extraClasspathElement>
-							<groupId>org.modelio.libreoffice</groupId>
-							<artifactId>com.sun.star.unoil</artifactId>
-							<version>3.6.0</version>
-						</extraClasspathElement>
-
-					</extraClasspathElements>
 				</configuration>
 			</plugin>
 
@@ -109,8 +76,50 @@
 				</executions>
 			</plugin>
 
+			<plugin>
+				<groupId>org.apache.maven.plugins</groupId>
+				<artifactId>maven-dependency-plugin</artifactId>
+				<version>2.10</version>
+				<executions>
+					<execution>
+						<id>copy-dependencies</id>
+						<phase>initialize</phase>
+						<goals>
+							<goal>copy-dependencies</goal>
+						</goals>
+						<configuration>
+							<includeScope>runtime</includeScope>
+							<stripVersion>true</stripVersion>
+						</configuration>
+					</execution>
+				</executions>
+			</plugin>
+
 		</plugins>
 	</build>
 
+	<dependencies>
+		<dependency>
+			<groupId>org.libreoffice</groupId>
+			<artifactId>juh</artifactId>
+			<version>6.4.3</version>
+		</dependency>
+		<dependency>
+			<groupId>org.libreoffice</groupId>
+			<artifactId>jurt</artifactId>
+			<version>6.4.3</version>
+		</dependency>
+		<dependency>
+			<groupId>org.libreoffice</groupId>
+			<artifactId>ridl</artifactId>
+			<version>6.4.3</version>
+		</dependency>
+		<dependency>
+			<groupId>org.libreoffice</groupId>
+			<artifactId>unoil</artifactId>
+			<version>6.4.3</version>
+		</dependency>
+	</dependencies>
+
 </project>
 
diff --git a/modelio/app/editors.richnote.microsoft/META-INF/MANIFEST.MF b/modelio/app/editors.richnote.microsoft/META-INF/MANIFEST.MF
index bf81c9c..6dd6bd1 100644
--- a/modelio/app/editors.richnote.microsoft/META-INF/MANIFEST.MF
+++ b/modelio/app/editors.richnote.microsoft/META-INF/MANIFEST.MF
@@ -23,5 +23,7 @@ Import-Package: javax.annotation;version="1.1.0",
  javax.inject;version="1.0.0"
 Bundle-Activator: org.modelio.editors.richnote.microsoft.plugin.MicrosoftEditors
 Bundle-ClassPath: res/,
+ lib/javadesigner.jar,
+ lib/eclipse.jar,
  .
 
diff --git a/modelio/app/editors.richnote.microsoft/build.properties b/modelio/app/editors.richnote.microsoft/build.properties
index 25f7d7a..c0d3b40 100644
--- a/modelio/app/editors.richnote.microsoft/build.properties
+++ b/modelio/app/editors.richnote.microsoft/build.properties
@@ -6,4 +6,6 @@ bin.includes = META-INF/,\
                .,\
                res/,\
                e4model/,\
-               plugin.xml
+               plugin.xml,\
+               lib/javadesigner.jar,\
+               lib/eclipse.jar
diff --git a/modelio/platform.core/core.utils/META-INF/MANIFEST.MF b/modelio/platform.core/core.utils/META-INF/MANIFEST.MF
index ba01e91..72c3d11 100644
--- a/modelio/platform.core/core.utils/META-INF/MANIFEST.MF
+++ b/modelio/platform.core/core.utils/META-INF/MANIFEST.MF
@@ -15,7 +15,8 @@ Export-Package: org.modelio.vbasic.auth,
  org.modelio.vbasic.version,
  org.modelio.vbasic.xml
 Bundle-ClassPath: res/,
- .
+ .,
+ target/dependency/jaxb-api.jar
 Require-Bundle: org.apache.httpcomponents.httpclient,
  org.apache.httpcomponents.httpcore,
  org.apache.commons.commons-compress
diff --git a/modelio/platform.core/core.utils/build.properties b/modelio/platform.core/core.utils/build.properties
index 05bd7f4..66382b5 100644
--- a/modelio/platform.core/core.utils/build.properties
+++ b/modelio/platform.core/core.utils/build.properties
@@ -7,4 +7,5 @@ javacTarget=1.8
 bin.includes = META-INF/,\
                .,\
                res/,\
-               lib/
+               lib/,\
+               target/dependency/jaxb-api.jar
diff --git a/modelio/platform.core/core.utils/pom.xml b/modelio/platform.core/core.utils/pom.xml
index 539960b..ed3c871 100644
--- a/modelio/platform.core/core.utils/pom.xml
+++ b/modelio/platform.core/core.utils/pom.xml
@@ -12,4 +12,35 @@
 	<artifactId>org.modelio.core.utils</artifactId>
 	<packaging>eclipse-plugin</packaging>
 
+	<dependencies>
+	    <dependency>
+	      <groupId>javax.xml.bind</groupId>
+	      <artifactId>jaxb-api</artifactId>
+	      <version>2.3.0</version>
+	    </dependency>
+	</dependencies>
+
+	<build>
+        <plugins>
+          <plugin>
+             <groupId>org.apache.maven.plugins</groupId>
+             <artifactId>maven-dependency-plugin</artifactId>
+             <version>2.10</version>
+             <executions>
+                 <execution>
+                     <id>copy-dependencies</id>
+                     <phase>initialize</phase>
+                     <goals>
+                         <goal>copy-dependencies</goal>
+                     </goals>
+                     <configuration>
+                         <includeScope>runtime</includeScope>
+                         <stripVersion>true</stripVersion>
+                     </configuration>
+                 </execution>
+             </executions>
+         </plugin>
+        </plugins>
+    </build>
+
 </project>
diff --git a/pom.xml b/pom.xml
index c113705..086bfec 100644
--- a/pom.xml
+++ b/pom.xml
@@ -165,6 +165,7 @@ This pom executes a maven target on ALL the (eclipse) features that compose the
 					<version>${tycho-version}</version>
 					<configuration>
 						<encoding>UTF-8</encoding>
+						<compilerArgument>-warn:+discouraged,forbidden</compilerArgument>
 					</configuration>
 				</plugin>
 			</plugins>
-- 
2.27.0

